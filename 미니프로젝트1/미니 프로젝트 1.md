<h1>[ë¯¸ë‹ˆ í”„ë¡œì íŠ¸1] ë¦¬ëˆ…ìŠ¤ ì¸í”„ë¼ êµ¬ì¶•ì„ í†µí•œ WordPress êµ¬í˜„</h1>




<h3>ğŸ“ŒINDEX</h3>

- [í”„ë¡œì íŠ¸ ëª©ì  ë° í™˜ê²½Â·êµ¬ì„±](#í”„ë¡œì íŠ¸-ëª©ì -ë°-í™˜ê²½êµ¬ì„±)
- í”„ë¡œì íŠ¸ ê³¼ì • 
    - [DBì„œë²„ íŒ¨í‚¤ì§€ ì„¤ì¹˜ ë° ë„¤íŠ¸ì›Œí¬ ì„¤ì •](#dbì„œë²„-íŒ¨í‚¤ì§€-ì„¤ì¹˜-ë°-ë„¤íŠ¸ì›Œí¬-ì„¤ì •)
    - [Web ì„œë²„ íŒ¨í‚¤ì§€ ì„¤ì¹˜ ë° ë„¤íŠ¸ì›Œí¬ ì„¤ì •](#web-ì„œë²„-íŒ¨í‚¤ì§€-ì„¤ì¹˜-ë°-ë„¤íŠ¸ì›Œí¬-ì„¤ì •)
    - [DB ì„œë²„: wordpress ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •](#db-ì„œë²„-wordpress-ë°ì´í„°ë² ì´ìŠ¤-ì„¤ì •)
    - [Web ì„œë²„: wordpress ì„¤ì¹˜](#web-ì„œë²„-wordpress-ì„¤ì¹˜)
    - [Web ì„œë²„: wordpress êµ¬ì„±](#web-ì„œë²„-wordpress-êµ¬ì„±)
    - [Web ì„œë²„: apache ì„¤ì •](#web-ì„œë²„-apache-ì„¤ì •)
    - [DBì„œë²„ & ì›¹ ì„œë²„ ì—°ê²°ì™„ë£Œ](#dbì„œë²„--ì›¹-ì„œë²„-ì—°ê²°ì™„ë£Œ)
    - [DNS ì„œë²„ ì„¤ì •](#dns-ì„œë²„-ì„¤ì •)
    - [Web ì„œë²„ : dns ì£¼ì†Œ ë“±ë¡ ë° ë„ë©”ì¸ ë“±ë¡](#web-ì„œë²„--dns-ì£¼ì†Œ-ë“±ë¡-ë°-ë„ë©”ì¸-ë“±ë¡)
- [í”„ë¡œì íŠ¸ ìµœì¢… ê²°ê³¼](#í”„ë¡œì íŠ¸-ìµœì¢…-ê²°ê³¼)

<br>

<br>



<h2>í”„ë¡œì íŠ¸ ëª©ì  ë° í™˜ê²½Â·êµ¬ì„±</h2>

- ëª©ì : **ë¦¬ëˆ…ìŠ¤ ì¸í”„ë¼ êµ¬ì¶•ì„ í†µí•œ wordpress êµ¬í˜„**

- **ì¸í”„ë¼ êµ¬ì¶•í™˜ê²½**
  - Wordpress
  - ì›¹ ì„œë²„ : apached
  - PHP : ë™ì  ì»¨í…ì¸  ì´ìš©
  - DB ì„œë²„ : MariaDB
  - DNS ì„œë²„ : named

- **ì„œë²„ êµ¬ì„±**
  - ì›¹ ì„œë²„ (apache + PHP + wordpress)
  - DNS ì„œë²„
  - DB ì„œë²„

<br>

<br>

<h2>DBì„œë²„ íŒ¨í‚¤ì§€ ì„¤ì¹˜ ë° ë„¤íŠ¸ì›Œí¬ ì„¤ì •</h2>

- ë¦´ë¦¬ì¦ˆ ë²„ì „ í™•ì¸

```shell
[root@localhost ~]# cat /etc/redhat-release
CentOS Linux release 7.5.1804 (Core)
```

- yum ì—…ë°ì´íŠ¸

```shell
[root@localhost ~]# yum -y update
...
```

- MariaDB.repo íŒŒì¼ ìƒì„±
  - viì—ë””í„°ë¥¼ í†µí•´ í•´ë‹¹ ë‚´ìš© ì €ì¥

```shell
[root@localhost ~]# cat /etc/yum.repos.d/MariaDB.repo
#MariaDB 10.2 CentOS repository list - created 2022-03-09 15:37 UTC
# https://mariadb.org/download/
[mariadb]
name = MariaDB
baseurl = https://mirror.yongbok.net/mariadb/yum/10.2/centos7-amd64
gpgkey=https://mirror.yongbok.net/mariadb/yum/RPM-GPG-KEY-MariaDB
gpgcheck=1
```

- Mariadb-server ë²„ì „í™•ì¸
  - ë²„ì „ 10.2.43 ì„ì„ í™•ì¸

```shell
[root@localhost ~]# yum info Mariadb-server
Loaded plugins: fastestmirror, langpacks
Loading mirror speeds from cached hostfile
 * base: mirror.kakao.com
 * extras: mirror.kakao.com
 * updates: mirror.kakao.com
mariadb                                              | 3.4 kB     00:00
(1/2): mariadb/updateinfo                              | 5.8 kB   00:00
(2/2): mariadb/primary_db                              |  59 kB   00:00
Available Packages
Name        : MariaDB-server
Arch        : x86_64
Version     : 10.2.43
Release     : 1.el7.centos
Size        : 24 M
Repo        : mariadb
Summary     : MariaDB database server binaries
URL         : http://mariadb.org
License     : GPLv2
Description : MariaDB: a very fast and robust SQL database server
            :
            : It is GPL v2 licensed, which means you can use the it free of
            : charge under the conditions of the GNU General Public License
            : Version 2 (http://www.gnu.org/licenses/).
            :
            : MariaDB documentation can be found at https://mariadb.com/kb
            : MariaDB bug reports should be submitted through
            : https://jira.mariadb.org

Name        : mariadb-server
Arch        : x86_64
Epoch       : 1
Version     : 5.5.68
Release     : 1.el7
Size        : 11 M
Repo        : base/7/x86_64
Summary     : The MariaDB server and related files
URL         : http://mariadb.org
License     : GPLv2 with exceptions and LGPLv2 and BSD
Description : MariaDB is a multi-user, multi-threaded SQL database server.
            : It is a client/server implementation consisting of a server
            : daemon (mysqld) and many different client programs and
            : libraries. This package contains the MariaDB server and some
            : accompanying files and directories. MariaDB is a community
            : developed branch of MySQL.
```

- yumì„ ì´ìš©í•˜ì—¬ mariaDB ì„¤ì¹˜

```shell
[root@localhost ~]# yum install -y MariaDB-server MariaDB-client
Loaded plugins: fastestmirror, langpacks
Loading mirror speeds from cached hostfile
 * base: mirror.kakao.com
 * extras: mirror.kakao.com
 * updates: mirror.kakao.com
Resolving Dependencies
--> Running transaction check
---> Package MariaDB-client.x86_64 0:10.2.43-1.el7.centos will be installed
--> Processing Dependency: MariaDB-common for package: MariaDB-client-10.2.43-1.el7.centos.x86_64
---> Package MariaDB-server.x86_64 0:10.2.43-1.el7.centos will be installed
--> Processing Dependency: galera for package: MariaDB-server-10.2.43-1.el7.centos.x86_64
--> Running transaction check
---> Package MariaDB-common.x86_64 0:10.2.43-1.el7.centos will be installed
--> Processing Dependency: MariaDB-compat for package: MariaDB-common-10.2.43-1.el7.centos.x86_64
---> Package galera.x86_64 0:25.3.35-1.el7.centos will be installed
--> Processing Dependency: libboost_program_options-mt.so.1.53.0()(64bit) for package: galera-25.3.35-1.el7.centos.x86_64
--> Running transaction check
---> Package MariaDB-compat.x86_64 0:10.2.43-1.el7.centos will be obsoleting
---> Package boost-program-options.x86_64 0:1.53.0-28.el7 will be installed
---> Package mariadb-libs.x86_64 1:5.5.68-1.el7 will be obsoleted
--> Finished Dependency Resolution

Dependencies Resolved

============================================================================
 Package                 Arch     Version                   Repository
                                                                       Size
============================================================================
Installing:
 MariaDB-client          x86_64   10.2.43-1.el7.centos      mariadb    11 M
 MariaDB-compat          x86_64   10.2.43-1.el7.centos      mariadb   2.2 M
     replacing  mariadb-libs.x86_64 1:5.5.68-1.el7
 MariaDB-server          x86_64   10.2.43-1.el7.centos      mariadb    24 M
Installing for dependencies:
 MariaDB-common          x86_64   10.2.43-1.el7.centos      mariadb    81 k
 boost-program-options   x86_64   1.53.0-28.el7             base      156 k
 galera                  x86_64   25.3.35-1.el7.centos      mariadb   8.1 M

Transaction Summary
============================================================================
Install  3 Packages (+3 Dependent packages)

Total download size: 45 M
Downloading packages:
ê²½ê³ : /var/cache/yum/x86_64/7/mariadb/packages/MariaDB-common-10.2.43-1.el7.centos.x86_64.rpm: Header V4 DSA/SHA1 Signature, key ID 1bb943db: NOKEY
Public key for MariaDB-common-10.2.43-1.el7.centos.x86_64.rpm is not installed
(1/6): MariaDB-common-10.2.43-1.el7.centos.x86_64.rpm  |  81 kB   00:01
(2/6): MariaDB-compat-10.2.43-1.el7.centos.x86_64.rpm  | 2.2 MB   00:00
(3/6): boost-program-options-1.53.0-28.el7.x86_64.rpm  | 156 kB   00:00
(4/6): MariaDB-client-10.2.43-1.el7.centos.x86_64.rpm  |  11 MB   00:04
(5/6): galera-25.3.35-1.el7.centos.x86_64.rpm          | 8.1 MB   00:02
(6/6): MariaDB-server-10.2.43-1.el7.centos.x86_64.rpm  |  24 MB   00:08
----------------------------------------------------------------------------
...
```

- MariaDB íŒ¨í‚¤ì§€ ì´ë¦„ í™•ì¸

```shel;
[root@localhost ~]# rpm -qa MariaDB*
MariaDB-server-10.2.43-1.el7.centos.x86_64
MariaDB-client-10.2.43-1.el7.centos.x86_64
MariaDB-common-10.2.43-1.el7.centos.x86_64
MariaDB-compat-10.2.43-1.el7.centos.x86_64
```

- MariaDB-server ì‹¤í–‰íŒŒì¼, ë°ëª¬ëª… í™•ì¸
  - grep ëª…ë ¹ì–´ë¥¼ í•¨ê»˜ ì‚¬ìš©í•˜ì—¬ ë¹ ë¥´ê²Œ í™•ì¸

```shell
[root@localhost ~]# rpm -ql MariaDB-server | grep mariadb.service
/usr/bin/mariadb-service-convert
/usr/lib/systemd/system/mariadb.service
/usr/share/man/man1/mariadb-service-convert.1.gz
/usr/share/mysql/systemd/mariadb.service
```

```shell
[root@localhost ~]# rpm -ql MariaDB-server | grep mysql_secure_installation
/usr/bin/mysql_secure_installation
/usr/share/man/man1/mysql_secure_installation.1.gz
```

- mariadb.service ì‹œì‘ ë° í™œì„±í™”

```shell
[root@localhost ~]# systemctl start mariadb.service
[root@localhost ~]# systemctl enable mariadb.service
Created symlink from /etc/systemd/system/mysql.service to /usr/lib/systemd/system/mariadb.service.
Created symlink from /etc/systemd/system/mysqld.service to /usr/lib/systemd/system/mariadb.service.
Created symlink from /etc/systemd/system/multi-user.target.wants/mariadb.service to /usr/lib/systemd/system/mariadb.service.
```

- mysql_secure_installtion ë³´ì•ˆ ì„¤ì •
  - root ì•”í˜¸ ì„¤ì •
  - anonymous ì ‘ì† ì°¨ë‹¨
  - ì›ê²© ì ‘ì† í—ˆìš© X 
    - ì›¹ì„œë²„ì™€ DBì„œë²„ë¥¼ ë”°ë¡œ êµ¬í˜„í•  ì˜ˆì •ì´ë¯€ë¡œ
  - test ë°ì´í„°ë² ì´ìŠ¤ ì‚­ì œ 
  - ì €ì¥

```shell
[root@localhost ~]# mysql_secure_installation

NOTE: RUNNING ALL PARTS OF THIS SCRIPT IS RECOMMENDED FOR ALL MariaDB
      SERVERS IN PRODUCTION USE!  PLEASE READ EACH STEP CAREFULLY!

In order to log into MariaDB to secure it, we'll need the current
password for the root user.  If you've just installed MariaDB, and
you haven't set the root password yet, the password will be blank,
so you should just press enter here.

Enter current password for root (enter for none):
OK, successfully used password, moving on...

Setting the root password ensures that nobody can log into the MariaDB
root user without the proper authorisation.

Set root password? [Y/n] y
New password:
Re-enter new password:
Password updated successfully!
Reloading privilege tables..
 ... Success!


By default, a MariaDB installation has an anonymous user, allowing anyone
to log into MariaDB without having to have a user account created for
them.  This is intended only for testing, and to make the installation
go a bit smoother.  You should remove them before moving into a
production environment.

Remove anonymous users? [Y/n] y
 ... Success!

Normally, root should only be allowed to connect from 'localhost'.  This
ensures that someone cannot guess at the root password from the network.

Disallow root login remotely? [Y/n] no
 ... skipping.

By default, MariaDB comes with a database named 'test' that anyone can
access.  This is also intended only for testing, and should be removed
before moving into a production environment.

Remove test database and access to it? [Y/n] yes
 - Dropping test database...
 ... Success!
 - Removing privileges on test database...
 ... Success!

Reloading the privilege tables will ensure that all changes made so far
will take effect immediately.

Reload privilege tables now? [Y/n] y
 ... Success!

Cleaning up...

All done!  If you've completed all of the above steps, your MariaDB
installation should now be secure.

Thanks for using MariaDB!
```

- ë°©í™”ë²½ì— mariadb (3306í¬íŠ¸ ì¶”ê°€)
  - ì›¹ì„œë²„ì™€ DBë¥¼ ë³„ë„ë¡œ í•  ì˜ˆì •ì´ë¯€ë¡œ
  - ì„¤ì • í›„ --list-all ì˜µì…˜ì„ í†µí•´ ì¶”ê°€ëœ ê²ƒ í™•ì¸

```shell
[root@localhost ~]# systemctl enable mariadb.service
[root@localhost ~]# firewall-cmd --add-port=3306/tcp --zone=public --permanent
success
[root@localhost ~]# firewall-cmd --reload
success
[root@localhost ~]# firewall-cmd --list-all
public (active)
  target: default
  icmp-block-inversion: no
  interfaces: enp0s3 enp0s8 enp0s9
  sources:
  services: dhcpv6-client ssh
  ports: 3306/tcp
  protocols:
  masquerade: no
  forward-ports:
  source-ports:
  icmp-blocks:
  rich rules:
```

- ê³ ì • ip ì„¤ì •

```shell
[root@localhost ~]# nmcli con add con-name static_db ifname enp0s8 type ethernet ip4 192.168.56.107/24 gw4 192.168.56.1
[root@localhost ~]# nmcli con up static_db
```

- í˜¸ìŠ¤íŠ¸ëª… ë³€ê²½

```shell
[root@localhost ~]# hostnamectl set-hostname dbserver
[root@localhost ~]# hostname
dbserver
```





<h2>Web ì„œë²„ íŒ¨í‚¤ì§€ ì„¤ì¹˜ ë° ë„¤íŠ¸ì›Œí¬ ì„¤ì •</h2>

- DBì„œë²„ì™€ ë™ì¼í•˜ê²Œ yum update ì™„ë£Œ
- ì›¹ì„œë²„ ì„¤ì¹˜ ë° í™•ì¸

```shell
[root@localhost ~]# yum install httpd
Loaded plugins: fastestmirror, langpacks
Loading mirror speeds from cached hostfile
 * base: mirror.kakao.com
 * extras: mirror.kakao.com
 * updates: mirror.kakao.com
base                                                 | 3.6 kB     00:00
extras                                               | 2.9 kB     00:00
mariadb                                              | 3.4 kB     00:00
updates                                              | 2.9 kB     00:00
Package httpd-2.4.6-97.el7.centos.4.x86_64 already installed and latest version
Nothing to do
[root@localhost ~]# rpm -qa httpd
httpd-2.4.6-97.el7.centos.4.x86_64
```

```shell
[root@localhost ~]# yum install httpd
Loaded plugins: fastestmirror, langpacks
Loading mirror speeds from cached hostfile
 * base: mirror.anigil.com
 * extras: mirror.anigil.com
 * updates: ftp.riken.jp
Package httpd-2.4.6-97.el7.centos.4.x86_64 already installed and latest version
Nothing to do
[root@localhost ~]# rpm -aq httpd
httpd-2.4.6-97.el7.centos.4.x86_64
[root@localhost ~]# rpm -ql httpd
/etc/httpd
/etc/httpd/conf
/etc/httpd/conf.d
/etc/httpd/conf.d/README
/etc/httpd/conf.d/autoindex.conf
/etc/httpd/conf.d/userdir.conf
/etc/httpd/conf.d/welcome.conf
```

- ë°©í™”ë²½ ì„¤ì •

```shell
[root@localhost ~]# firewall-cmd --add-service=http --permanent
success
[root@localhost ~]# firewall-cmd --list-all
public (active)
  target: default
  icmp-block-inversion: no
  interfaces: enp0s3 enp0s8
  sources:
  services: dhcpv6-client http ssh
  ports:
  protocols:
  masquerade: no
  forward-ports:
  source-ports:
  icmp-blocks:
  rich rules:
```

- PHP ì„¤ì¹˜ ê³¼ì •

```
[root@localhost ~]# yum install https://rpms.remirepo.net/enterprise/remi-release-7.rpm
Loaded plugins: fastestmirror, langpacks
remi-release-7.rpm                                   |  23 kB     00:00
Examining /var/tmp/yum-root-iF3Njp/remi-release-7.rpm: remi-release-7.9-3.el7.remi.noarch
Marking /var/tmp/yum-root-iF3Njp/remi-release-7.rpm to be installed
Resolving Dependencies
--> Running transaction check
---> Package remi-release.noarch 0:7.9-3.el7.remi will be installed
--> Processing Dependency: epel-release = 7 for package: remi-release-7.9-3.el7.remi.noarch
Loading mirror speeds from cached hostfile
 * base: mirror.anigil.com
 * extras: mirror.anigil.com
 * updates: ftp.riken.jp
--> Running transaction check
---> Package epel-release.noarch 0:7-11 will be installed
--> Finished Dependency Resolution

Dependencies Resolved

============================================================================
 Package          Arch       Version              Repository           Size
============================================================================
Installing:
 remi-release     noarch     7.9-3.el7.remi       /remi-release-7      35 k
Installing for dependencies:
 epel-release     noarch     7-11                 extras               15 k

Transaction Summary
============================================================================
Install  1 Package (+1 Dependent package)

Total size: 50 k
Total download size: 15 k
Installed size: 59 k
Is this ok [y/d/N]: y
Downloading packages:
epel-release-7-11.noarch.rpm                           |  15 kB   00:00
Running transaction check
Running transaction test
Transaction test succeeded
Running transaction
  Installing : epel-release-7-11.noarch                                 1/2
  Installing : remi-release-7.9-3.el7.remi.noarch                       2/2
  Verifying  : remi-release-7.9-3.el7.remi.noarch                       1/2
  Verifying  : epel-release-7-11.noarch                                 2/2

Installed:
  remi-release.noarch 0:7.9-3.el7.remi

Dependency Installed:
  epel-release.noarch 0:7-11

Complete!
```

```shell
[root@localhost ~]# yum -y install yum-utils
Loaded plugins: fastestmirror, langpacks
Loading mirror speeds from cached hostfile
epel/x86_64/metalink                                 | 8.1 kB     00:00
 * base: mirror.anigil.com
 * epel: ftp.riken.jp
 * extras: mirror.anigil.com
 * remi-safe: ftp.riken.jp
 * updates: ftp.riken.jp
epel                                                 | 4.7 kB     00:00
remi-safe                                            | 3.0 kB     00:00
(1/4): epel/x86_64/group_gz                            |  96 kB   00:01
(2/4): epel/x86_64/updateinfo                          | 1.0 MB   00:02
(3/4): remi-safe/primary_db                            | 2.1 MB   00:05
(4/4): epel/x86_64/primary_db                          | 7.0 MB   00:07
Package yum-utils-1.1.31-54.el7_8.noarch already installed and latest version
Nothing to do
```

```shell
[root@localhost ~]# yum-config-manager --disable remi-php54 (php5.4ë²„ì „ ë„ê¸°)
[root@localhost ~]# yum-config-manager --enable remi-php74 (php7.4ë²„ì „ ì¼œê¸°)
```

- php ì„¤ì¹˜

```shell
[root@localhost ~]# yum install php74
[root@localhost ~]# yum install -y php74-php php-cli php74-scldevel
```

- ì›¹ ë°ëª¬ ì¬ì‹œì‘

```shell
[root@localhost ~]# systemctl restart httpd.service
[root@localhost ~]# systemctl status httpd.service
â— httpd.service - The Apache HTTP Server
   Loaded: loaded (/usr/lib/systemd/system/httpd.service; disabled; vendor preset: disabled)
   Active: active (running) since í™” 2022-03-15 10:11:16 KST; 6s ago
     Docs: man:httpd(8)
           man:apachectl(8)
 Main PID: 22357 (httpd)
   Status: "Processing requests..."
    Tasks: 7
   CGroup: /system.slice/httpd.service
           â”œâ”€22357 /usr/sbin/httpd -DFOREGROUND
           â”œâ”€22358 /usr/sbin/httpd -DFOREGROUND
           â”œâ”€22359 /usr/sbin/httpd -DFOREGROUND
           â”œâ”€22360 /usr/sbin/httpd -DFOREGROUND
           â”œâ”€22361 /usr/sbin/httpd -DFOREGROUND
           â”œâ”€22362 /usr/sbin/httpd -DFOREGROUND
           â””â”€22363 /usr/sbin/httpd -DFOREGROUND

 3ì›” 15 10:11:16 localhost.localdomain systemd[1]: Starting The Apache H...
 3ì›” 15 10:11:16 localhost.localdomain httpd[22357]: AH00558: httpd: Cou...
 3ì›” 15 10:11:16 localhost.localdomain systemd[1]: Started The Apache HT...
Hint: Some lines were ellipsized, use -l to show in full.
```

- php ë° httpd ë²„ì „ í™•ì¸

```shell
[root@localhost ~]# rpm -qa php74
php74-1.0-3.el7.remi.x86_64
[root@localhost ~]# rpm -qa httpd
httpd-2.4.6-97.el7.centos.4.x86_64
```

- ê³ ì • ip ì„¤ì •

```shell
[root@localhost ~]# nmcli con add con-name static_web ifname enp0s8 type ethernet ip4 192.168.56.101/24 gw4 192.168.56.2
ì—°ê²° 'static_web' (d8a09917-af58-4986-9942-33e2f7cc1ba4)ì´ ì„±ê³µì ìœ¼ë¡œ ì¶”ê°€ë˜ì—ˆìŠµë‹ˆë‹¤.
[root@localhost ~]# nmcli con up static_web
ì—°ê²°ì´ ì„±ê³µì ìœ¼ë¡œ í™œì„±í™”ë˜ì—ˆìŠµë‹ˆë‹¤ (D-Bus í™œì„± ê²½ë¡œ: /org/freedesktop/NetworkManager/ActiveConnection/5)
```

- í˜¸ìŠ¤íŠ¸ëª… ì„¤ì •

```shell
[root@localhost ~]# hostnamectl set-hostname webserver
[root@localhost ~]# hostname
webserver
```

- phpì˜ MySQLì„ í™•ì¥íŒ¨í‚¤ì§€ ì„¤ì¹˜

```shell
[root@localhost ~]# yum install php php-mysql
```



<h2>DB ì„œë²„: wordpress ë°ì´í„°ë² ì´ìŠ¤ ì„¤ì •</h2>

- ë°ì´í„°ë² ì´ìŠ¤ ì›ê²© ì ‘ì† í—ˆìš©

```shell
[root@dbserver ~]# mysql -u root -p
Enter password:
Welcome to the MariaDB monitor.  Commands end with ; or \g.
Your MariaDB connection id is 8
Server version: 10.2.43-MariaDB MariaDB Server

Copyright (c) 2000, 2018, Oracle, MariaDB Corporation Ab and others.

Type 'help;' or '\h' for help. Type '\c' to clear the current input statement.

MariaDB [(none)]> CREATE DATABASE wordpress;
Query OK, 1 row affected (0.00 sec)

MariaDB [(none)]> USE wordpress
Database changed
MariaDB [wordpress]> CREATE USER adminuser@loaclhost IDENTIFIED BY 'dkagh1.';
Query OK, 0 rows affected (0.00 sec)

MariaDB [wordpress]> GRANT ALL PRIVILEGES ON wordpress.* TO adminuser@'%' IDENTIFIED BY 'dkagh1.';
Query OK, 0 rows affected (0.00 sec)

MariaDB [wordpress]> FLUSH PRIVILEGES;
Query OK, 0 rows affected (0.00 sec)

MariaDB [wordpress]> exit
Bye
```





<h2>Web ì„œë²„: wordpress ì„¤ì¹˜</h2>

- URLë¡œ ì„¤ì¹˜í•˜ê¸° ìœ„í•œ wget íŒ¨í‚¤ì§€ ì„¤ì¹˜

```shell
[root@webserver ~]# yum -y install wget
Loaded plugins: fastestmirror, langpacks
Loading mirror speeds from cached hostfile
 * base: mirror.anigil.com
 * epel: ftp.riken.jp
 * extras: mirror.anigil.com
 * remi-php74: ftp.riken.jp
 * remi-safe: ftp.riken.jp
 * updates: ftp.riken.jp
Package wget-1.14-18.el7_6.1.x86_64 already installed and latest version
Nothing to do
```

- URLë¡œ wordpress ì„¤ì¹˜
  - URL:  https://wordpress.org/latest.tar.gz

```shell
[root@webserver ~]# wget https://wordpress.org/latest.tar.gz
--2022-03-15 10:51:31--  https://wordpress.org/latest.tar.gz
Resolving wordpress.org (wordpress.org)... 198.143.164.252
Connecting to wordpress.org (wordpress.org)|198.143.164.252|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 18722604 (18M) [application/octet-stream]
Saving to: â€˜latest.tar.gzâ€™

28% [=========>                         ] 5,418,601   14.9KB/s   in 1m 47s

2022-03-15 11:08:18 (49.4 KB/s) - Read error at byte 5418601/18722604 (ì„±ê³µ). Retrying.

--2022-03-15 11:08:19--  (try: 2)  https://wordpress.org/latest.tar.gz
Connecting to wordpress.org (wordpress.org)|198.143.164.252|:443... connected.
HTTP request sent, awaiting response... 206 Partial Content
Length: 18722604 (18M), 13304003 (13M) remaining [application/octet-stream]
Saving to: â€˜latest.tar.gzâ€™

100%[++++++++++========================>] 18,722,604  1.86MB/s   in 24s

2022-03-15 11:08:45 (530 KB/s) - â€˜latest.tar.gzâ€™ saved [18722604/18722604]

[root@webserver ~]# file latest.tar.gz
latest.tar.gz: gzip compressed data, from Unix, last modified: Fri Mar 11 09:39:52 2022
```

- -C ì˜µì…˜ì„ í†µí•´ ìœ„ì¹˜ ì§€ì •í•˜ì—¬ ì•„ì¹´ì´ë¸Œ í•´ì œ
  - í•´ì œí•  ë””ë ‰í† ë¦¬: /var/www/html

```shell
[root@webserver ~]# tar -xvzf latest.tar.gz -C /var/www/html
wordpress/
wordpress/xmlrpc.php
wordpress/wp-blog-header.php
wordpress/readme.html
wordpress/wp-signup.php
wordpress/index.php
wordpress/wp-cron.php
wordpress/wp-config-sample.php
wordpress/wp-login.php
wordpress/wp-settings.php
wordpress/license.txt
wordpress/wp-content/
....
```

```shell
[root@webserver ~]# ls /var/www/html/wordpress
index.php        wp-blog-header.php    wp-includes        wp-settings.php
license.txt      wp-comments-post.php  wp-links-opml.php  wp-signup.php
readme.html      wp-config-sample.php  wp-load.php        wp-trackback.php
wp-activate.php  wp-content            wp-login.php       xmlrpc.php
wp-admin         wp-cron.php           wp-mail.php
```



-  ê²Œì‹œíŒì— ì—…ë¡œë“œë˜ëŠ” íŒŒì¼ì„ ì €ì¥í•˜ê¸° ìœ„í•œ ë””ë ‰í† ë¦¬ ìƒì„±

```shell
[root@webserver ~]# mkdir /var/www/html/wordpress/uploads
```



<br>

<br>

<h2>Web ì„œë²„: wordpress êµ¬ì„±</h2>

- wordpress ìƒ˜í”Œ íŒŒì¼ í™•ì¸

```shell
[root@webserver ~]# ls -l /var/www/html/wordpress/wp-config-sample.php
-rw-r--r--. 1 nobody nfsnobody 3001 12ì›” 14 17:44 /var/www/html/wordpress/wp-config-sample.php
```

- /var/www/html/wordpress/ ë¡œ ì´ë™

```shell
[root@webserver ~]# cd /var/www/html/wordpress/
[root@webserver wordpress]#
```

- wp-config-sample.php íŒŒì¼ì„ ë³µì‚¬í•˜ì—¬ ì‚¬ìš©

```shell
[root@webserver wordpress]# cp wp-config-sample.php wp-config.php
```

- ì••ì¶•í•´ì œëœ wordpress ë””ë ‰í† ë¦¬ì™€ ê·¸ í•˜ìœ„ ë””ë ‰í† ë¦¬ì˜ ì†Œìœ ì,ì†Œìœ ê·¸ë£¹ì„ apacheë¡œ ë³€ê²½

```shell
[root@webserver wordpress]# chown -R apache:apache /var/www/html/wordpress
```

```shell
[root@webserver wordpress]# ls -l /var/www/html/wordpress/
í•©ê³„ 216
-rw-r--r--.  1 apache apache   405  2ì›”  6  2020 index.php
-rw-r--r--.  1 apache apache 19915  1ì›”  1 09:15 license.txt
-rw-r--r--.  1 apache apache  7437 12ì›” 29 02:38 readme.html
drwxr-xr-x.  2 apache apache     6  3ì›” 15 11:28 uploads
-rw-r--r--.  1 apache apache  7165  1ì›” 21  2021 wp-activate.php
drwxr-xr-x.  9 apache apache  4096  3ì›” 11 09:39 wp-admin
-rw-r--r--.  1 apache apache   351  2ì›”  6  2020 wp-blog-header.php
-rw-r--r--.  1 apache apache  2338 11ì›” 10 08:07 wp-comments-post.php
-rw-r--r--.  1 apache apache  3001 12ì›” 14 17:44 wp-config-sample.php
-rw-r--r--.  1 apache apache  3001  3ì›” 15 11:37 wp-config.php
drwxr-xr-x.  4 apache apache    52  3ì›” 11 09:39 wp-content
-rw-r--r--.  1 apache apache  3939  8ì›”  4  2021 wp-cron.php
drwxr-xr-x. 26 apache apache 12288  3ì›” 11 09:39 wp-includes
-rw-r--r--.  1 apache apache  2496  2ì›”  6  2020 wp-links-opml.php
-rw-r--r--.  1 apache apache  3900  5ì›” 16  2021 wp-load.php
-rw-r--r--.  1 apache apache 47916  1ì›”  4 17:30 wp-login.php
-rw-r--r--.  1 apache apache  8582  9ì›” 23 06:01 wp-mail.php
-rw-r--r--.  1 apache apache 23025 12ì›”  1 02:32 wp-settings.php
-rw-r--r--.  1 apache apache 31959 10ì›” 25 09:23 wp-signup.php
-rw-r--r--.  1 apache apache  4747 10ì›”  9  2020 wp-trackback.php
-rw-r--r--.  1 apache apache  3236  6ì›”  9  2020 xmlrpc.php
```

- vim ì—ë””í„°ë¥¼ í†µí•´ wp-config.php íŒŒì¼ ìˆ˜ì •

```shell
[root@webserver wordpress]# cat wp-config.php
<?php
/**
 * The base configuration for WordPress
 *
 * The wp-config.php creation script uses this file during the installation.
 * You don't have to use the web site, you can copy this file to "wp-config.php"
 * and fill in the values.
 *
 * This file contains the following configurations:
 *
 * * Database settings
 * * Secret keys
 * * Database table prefix
 * * ABSPATH
 *
 * @link https://wordpress.org/support/article/editing-wp-config-php/
 *
 * @package WordPress
 */

// ** Database settings - You can get this info from your web host ** //
/** The name of the database for WordPress */
define( 'DB_NAME', '[ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„]' );

/** Database username */
define( 'DB_USER', '[ì‚¬ìš©ì]' );

/** Database password */
define( 'DB_PASSWORD', '[ì‚¬ìš©ì ì•”í˜¸]' );

/** Database hostname */
define( 'DB_HOST', '[ë°ì´í„°ë² ì´ìŠ¤ ì„œë²„ ipì£¼ì†Œ]' );

/** Database charset to use in creating database tables. */
define( 'DB_CHARSET', 'utf8' );

/** The database collate type. Don't change this if in doubt. */
define( 'DB_COLLATE', '' );
```



<br>

<br>

<h2>Web ì„œë²„: apache ì„¤ì •</h2>

- /etc/httpd/conf/httpd.conf íŒŒì¼ ìˆ˜ì •
  - DocumentRoot ìˆ˜ì • -> /var/www/html/wordpress
  - IfModule ìˆ˜ì • : index.html -> index.php

```shell
[root@webserver ~]# vim /etc/httpd/conf.d/httpd.conf
[root@webserver ~]# cat /etc/httpd/conf.d/httpd.conf
...
DocumentRoot "/var/www/html/wordpress"
...
<IfModule dir_module>
    DirectoryIndex index.php
</IfModule>
```

- SELinux ì„¤ì •

```shell
[root@webserver ~]# setenforce 0
```



<br>
<br>

<h2>DBì„œë²„ & ì›¹ ì„œë²„ ì—°ê²°ì™„ë£Œ</h2>

- http://[ipì£¼ì†Œ] ì ‘ê·¼
  - DocumentRoot : /var/www/html/wordpress



<img src="https://user-images.githubusercontent.com/64996121/158713794-043edd96-47ab-4f5d-bcce-481c33612dab.PNG" width=500 height=500 />



<img src="https://user-images.githubusercontent.com/64996121/158713972-27b126cd-63ff-442f-b339-36e1635fffa1.png" width=500 height=500 />



<img src="https://user-images.githubusercontent.com/64996121/158713997-13a23973-bcab-4c76-ab47-7e15a9e7b800.png" width=500 height=400 />



<img src="https://user-images.githubusercontent.com/64996121/158714025-b3c94fd1-1333-4f02-8ec1-e4c0a357b13d.png" width=500 height=300 />



- DBì„œë²„ì—ì„œ wordpress í…Œì´ë¸” í™•ì¸
  - ì •ìƒì ìœ¼ë¡œ ë°˜ì˜ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤

```shell
MariaDB [wordpress]> SHOW TABLEs;
+-----------------------+
| Tables_in_wordpress   |
+-----------------------+
| wp_commentmeta        |
| wp_comments           |
| wp_links              |
| wp_options            |
| wp_postmeta           |
| wp_posts              |
| wp_term_relationships |
| wp_term_taxonomy      |
| wp_termmeta           |
| wp_terms              |
| wp_usermeta           |
| wp_users              |
+-----------------------+
12 rows in set (0.00 sec)
```



<br>

<br>

<h2>DNS ì„œë²„ ì„¤ì •</h2>

- íŒ¨í‚¤ì§€ ì„¤ì¹˜

```shell
[root@server ~]# yum -y install bind bind-utils
```

- ë„¤íŠ¸ì›Œí¬ ì„¤ì •
  - gatewayì£¼ì†ŒëŠ” `ip route` ëª…ë ¹ì„ í†µí•´ í™•ì¸

```shell
[root@server ~]# nmcli con add con-name static_dns ifname ensp0s3 type ethernet ip4 10.0.2.10/24 gw4 10.0.2.1
[root@server ~]# nmcli con mod static_dns ipv4.dns 10.0.2.10
[root@server ~]# nmcli con up static_dns
```

```shell
[root@server ~]# cat /etc/resolv.conf
# Generated by NetworkManager
search ny.project.com
nameserver 10.0.2.10
```

- í˜¸ìŠ¤íŠ¸ë„¤ì„ ì„¤ì •

```shell
[root@server ~]# hostnamectl set-hostname [hostëª…]
```

- /etc/named.conf ì„¤ì •
  - 53ë²ˆ í¬íŠ¸ì— ëŒ€í•´ ëª¨ë“  ì ‘ì† í—ˆìš©
  - zone ì¶”ê°€

```shell
[root@server ~]# vi /etc/named.conf
...
options {
        listen-on port 53 { any; };
        listen-on-v6 port 53 { none; };
        directory       "/var/named";
        dump-file       "/var/named/data/cache_dump.db";
        statistics-file "/var/named/data/named_stats.txt"; 
        memstatistics-file "/var/named/data/named_mem_stats.txt"; 
        recursing-file  "/var/named/data/named.recursing";
        secroots-file   "/var/named/data/named.secroots";
        allow-query     { any; };
...
zone "." IN {
        type hint;
        file "named.ca";
};

//zone ì¶”ê°€
zone "ny.project.com" IN {
        type master; //master 1ì°¨ DNS serverë¡œ êµ¬ì„±
        file "ny.project.com.zone"; //zone íŒŒì¼ ì´ë¦„ ì§€ì •
};

```

- **/var/named => zone ì„¤ì •**

```shell
[root@server named]# cd /var/named
[root@server named]# cp named.empty ny.project.com.zone
[root@server named]# vi ny.project.com.zone
```

```shell
[root@server named]# cat encore.class4.zone
$TTL 3H
@       IN SOA  encore.class4.  root.encore.class4. (
                                        0       ; serial
                                        1D      ; refresh
                                        1H      ; retry
                                        1W      ; expire
                                        3H )    ; minimum
        NS      server.encore.class4. //ë„¤ì„ ì„œë²„ ì§€ì •
        A       10.0.2.1
dns     A       10.0.2.10
db      A       192.168.56.107
web     A       192.168.56.101
```

- ì„œë¹„ìŠ¤ í™œì„±í™”

```shell
[root@server named]# systemctl start named.service
[root@server named]# systemctl enable named.service
```

- ê¶Œí•œ ì„¤ì •

```
[root@server named]# chmod 660 ny.project.com.zone
[root@server named]# chown :named ny.project.com.zone
```

```shell
[root@server named]# ls -l ny.project.com.zone
-rw-rw----. 1 root named 254  3ì›” 16 09:53 ny.project.com.zone
[root@server named]# systemctl restart named.service
```

- ë°©í™”ë²½ ì„¤ì •

```shell
[root@server named]# firewall-cmd --add-service=dns --permanent
success
[root@server named]# firewall-cmd --reload
```

- ê²°ê³¼ í™•ì¸

```shell
[root@dns named]# host db.ny.project.com
db.ny.project.com has address 192.168.56.107
[root@dns named]# host web.ny.project.com
web.ny.project.com has address 192.168.56.101
```

- ì™¸ë¶€ì—ì„œì˜ ì ‘ì† í™•ì¸

```shell
[root@webserver ~]# nslookup
> db.ny.project.com
Server:         10.0.2.10
Address:        10.0.2.10#53

Name:   db.ny.project.com
Address: 192.168.56.107
```



â—½ ë§Œì•½ ì™¸ë¶€ì—ì„œ ì ‘ì† ì‹œ `** server can't find db.ny.project.com: nxdomain` ê³¼ ê°™ì€ ì—ëŸ¬ê°€ ëœ¬ë‹¤ë©´?

-> **ip ì£¼ì†Œê°€ ì¤‘ë³µë˜ì§„ ì•Šì•˜ëŠ”ì§€ í™•ì¸**í•´ë³´ì

ê¸€ì“´ì´ì˜ ê²¨ìš°, webì„œë²„ì˜ enp0s3(static3)ì˜ ipì£¼ì†Œì™€ DNSì„œë²„ì˜ ipì£¼ì†Œê°€ ë™ì¼í•˜ì—¬ ìœ„ì™€ ê°™ì€ ì—ëŸ¬ê°€ ë°œìƒí•˜ì˜€ë‹¤. enp0s3ì˜ ipì£¼ì†Œë¥¼ ë³€ê²½í•´ì¤Œìœ¼ë¡œì¨ ë¬¸ì œë¥¼ í•´ê²°í•  ìˆ˜ ìˆì—ˆë‹¤

<img src="https://user-images.githubusercontent.com/64996121/158714164-7c8cc2ea-005c-423f-9955-7c86c88fa656.png" weight=300 heigth=20 />

```shell
[root@webserver ~]# nmcli con mod static3 ipv4.addresses 10.0.2.8/24 ipv4.method manual
```



<br>

<br>

<h2>Web ì„œë²„ : dns ì£¼ì†Œ ë“±ë¡ ë° ë„ë©”ì¸ ë“±ë¡</h2>

- enp0s8ì„ ì‚¬ìš©í•˜ëŠ” ì›¹ ì„œë²„ì— ì•ì„œ ì„¤ì •í•œ dns ì£¼ì†Œë¥¼ ë“±ë¡
  - enp0s8(static)

```shell
[root@webserver ~]# nmcli con mod static ipv4.dns 10.0.2.10
```

- /var/www/html/wordpress/wp-config.php ìˆ˜ì •
  - DB_HOSTì˜ ê°’ì„ ë‹¤ìŒê³¼ ê°™ì´ DNS ì„œë²„ì—ì„œ ì„¤ì •í•œ ë„ë©”ì¸ëª…ìœ¼ë¡œ ë³€ê²½

```shell
...

// ** Database settings - You can get this info from your web host ** //
/** The name of the database for WordPress */
define( 'DB_NAME', '[ë°ì´í„°ë² ì´ìŠ¤ ì´ë¦„]' );

/** Database username */
define( 'DB_USER', '[ì‚¬ìš©ì]' );

/** Database password */
define( 'DB_PASSWORD', '[ì‚¬ìš©ì ì•”í˜¸]' );

/** Database hostname */
define( 'DB_HOST','db.ny.project.com');

/** Database charset to use in creating database tables. */
define( 'DB_CHARSET', 'utf8' );

/** The database collate type. Don't change this if in doubt. */
define( 'DB_COLLATE', '' );
...
```

- ì‹œìŠ¤í…œ ì¬ì‹œì‘

```shell
[root@webserver ~]# systemctl restart httpd
```



<br>

<br>

<h2>í”„ë¡œì íŠ¸ ìµœì¢… ê²°ê³¼</h2>

-  DBì„œë²„ì˜ ipì£¼ì†Œ ëŒ€ì‹  (DNS ì„œë²„ì— ì„¤ì •ëœ) **ë„ë©”ì¸ìœ¼ë¡œ ë“±ë¡ëœ Webì„œë²„**ë¡œ ì ‘ì†í–ˆì„ ë•Œ, ì •ìƒì ìœ¼ë¡œ ì§„í–‰ë˜ëŠ” ê²ƒì„ í™•ì¸í•¨ìœ¼ë¡œì¨ ì„±ê³µì ìœ¼ë¡œ **DBì„œë²„ & Webì„œë²„ & DNS ì„œë²„ê°€ ì—°ë™ë˜ì—ˆìŒì„  í™•ì¸**í•  ìˆ˜ ìˆë‹¤.

  <br>

<img src="https://user-images.githubusercontent.com/64996121/158543485-1aafd6fc-9cf6-472d-859b-cde90dd3802e.PNG" width=500 height=300 />

<br>

 - ìœˆë„ìš°ì— ë„ë©”ì¸ ë“±ë¡í•˜ê¸°

   - C:\Windows\System32\drivers ì˜ hosts íŒŒì¼ ë³µì‚¬
   - ë‚´ PC > ë¬¸ì„œì— ë¶™ì—¬ë„£ê¸°
   - hosts íŒŒì¼ ë©”ëª¨ì¥ìœ¼ë¡œ ì—´ê¸°
   - ë„ë©”ì¸ ë“±ë¡


  <img src="https://user-images.githubusercontent.com/64996121/158549921-f986c101-439a-432e-888f-e99c1abb1557.PNG" width=500 height=300 />
  <br>

  - ë³µì‚¬ í›„ C:\Windows\System32\driversì— ë‹¤ì‹œ ë¶™ì—¬ë„£ê¸°
    -  ê´€ë¦¬ì ê¶Œí•œìœ¼ë¡œ ë®ì–´ì”€
  - web ë¸Œë¼ìš°ì €ì— ë„ë©”ì¸ëª…ìœ¼ë¡œ ì ‘ì†ë˜ëŠ” ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŒ

<br>

  <img src="https://user-images.githubusercontent.com/64996121/158549963-85594584-7d00-46c4-aa55-99ad896f46eb.PNG" width=500 height=300 />





